function getCompressedBase64(e){return JSON.parse(document.getElementById("screenshot-data").textContent)[e]||""}function decodeBase64(e){let t=e.replace(/\s+/g,"").replace(/-/g,"+").replace(/_/g,"/");const n=t.length%4;n&&(t+="=".repeat(4-n));const a=atob(t),o=new Uint8Array(a.length);for(let e=0;e<a.length;e++)o[e]=a.charCodeAt(e);return o}function inflateToBlobUrl(e){const t=pako.inflateRaw(e),n=new Blob([t],{type:"image/png"});return URL.createObjectURL(n)}function toggleThumbnail(e){const t=document.getElementById(`thumbContainer${e}`),n=document.getElementById(`thumbImg${e}`),a=document.getElementById(`btnIcon${e}`),o=document.getElementById(`tooltipLabel${e}`);if("none"===t.style.display){if(t.style.display="block",!n.src){const e=decodeBase64(getCompressedBase64(t.dataset.compressed));n.src=inflateToBlobUrl(e),n.onload=()=>n.classList.add("loaded")}a.textContent="#",o.textContent="Hide Screenshot"}else t.style.display="none",a.textContent="⧉",o.textContent="Open Screenshot"}function openFullImage(e,t,n){const a=document.getElementById(`thumbImg${n}`),o=document.getElementById(e);document.getElementById(t).src=a.src,o.style.display="block"}function closeModal(e,t){const n=document.getElementById(e),a=document.getElementById(`thumbContainer${t}`),o=document.getElementById(`btnIcon${t}`),l=document.getElementById(`tooltipLabel${t}`);n.style.display="none",a.style.display="none",o.textContent="⧉",l.textContent="Open Screenshot"}function expandLogs(e){const t=e.nextElementSibling,n=e.closest(".step"),a=e.querySelector(".step-arrow"),o=n.classList.contains("expanded");"none"===t.style.display?a.classList.add("open"):a.classList.remove("open"),t.style.display=o?"none":"block",o||t.scrollIntoView({behavior:"smooth",block:"start"}),n.classList.toggle("expanded",!o)}$(document).ready((function(){$.fn.dataTable.isDataTable("#status")&&$("#status").DataTable().destroy();const e=$("#status").DataTable({autoWidth:!1,orderCellsTop:!0,fixedHeader:!0,lengthMenu:[[-1,10,25,50],["All",10,25,50]],pageLength:-1});$("#status thead tr:eq(1) th").each((function(t){$("input",this).on("keyup change",(function(){e.column(t).search()!==this.value&&e.column(t).search(this.value).draw()}))})),$(".filter-row, .dataTables_info, .dataTables_paginate, .dataTables_length, .dataTables_filter").hide(),$("#toggleFilters").on("click",(function(){$(".filter-row, .dataTables_info, .dataTables_paginate, .dataTables_length, .dataTables_filter").toggle()}))})),document.addEventListener("keydown",(function(e){"Escape"===e.key&&document.querySelectorAll('[id^="imageModal"]').forEach((e=>{if("block"===e.style.display){const t=e.id,n=t.replace("imageModal","");closeModal(t,parseInt(n))}}))}));const testSummaryData=window.testSummaryData||[],testBlockSummaryData=window.testBlockSummaryData||[],stepSummaryData=window.stepSummaryData||[],chartIds=["chart-slide-0","chart-slide-1","chart-slide-2"],canvasIds=["testSummaryChart","testBlockSummaryChart","stepSummaryChart"],chartDataSets=[testSummaryData,testBlockSummaryData,stepSummaryData],chartsInitialized={testSummaryChart:!1,testBlockSummaryChart:!1,stepSummaryChart:!1},prepareChartPayload=e=>{const t=e.find((e=>"Total"===e.label))||{},n=e.filter((e=>"Total"!==e.label));return{labels:n.map((e=>`${e.label} ${e.count}`)),values:n.map((e=>e.count)),colors:n.map((e=>e.color)),total:t.count||0,totalColor:t.color||"#34495e"}},renderPieChart=(e,t)=>{const n=document.getElementById(e).getContext("2d"),{labels:a,values:o,colors:l,total:s,totalColor:r}=prepareChartPayload(t);new Chart(n,{type:"pie",data:{labels:a,datasets:[{data:o,backgroundColor:l,borderWidth:1}]},options:{responsive:!1,maintainAspectRatio:!1,plugins:{legend:{position:"right",align:"end",labels:{font:{size:10},boxWidth:15,generateLabels:e=>{const t=e.data.datasets[0];return e.data.labels.map(((e,n)=>({text:e,fillStyle:t.backgroundColor[n],hidden:!1,index:n}))).concat({text:`Total: ${s}`,fillStyle:r,hidden:!1,index:-1})}}},tooltip:{callbacks:{label:e=>{const t=e.raw||0,n=(t/s*100).toFixed(1);return`${e.label}: ${t} (${n}%)`}}}},layout:{padding:{right:20,bottom:20}}}})},initializeChartOnce=(e,t)=>{const n=document.getElementById(e);0===n.offsetWidth||0===n.offsetHeight||chartsInitialized[e]||(renderPieChart(e,t),chartsInitialized[e]=!0)},showChart=e=>{chartIds.forEach(((t,n)=>{document.getElementById(t).style.display=n===e?"block":"none",n===e&&initializeChartOnce(canvasIds[n],chartDataSets[n])})),document.querySelectorAll(".dot").forEach(((t,n)=>t.classList.toggle("active",n===e)))},toggleSummaryPanel=()=>{const e=document.getElementById("summaryPanel"),t=document.getElementById("inline-summary"),n=document.getElementById("chart-toggle"),a="none"!==e.style.display;e.style.display=a?"none":"flex",t.style.display=a?"block":"none",n.textContent=a?"📊":"❌",a?(n.title="Show Charts",n.style.opacity=1):(n.title="Hide Charts",n.style.opacity=.5),a||(Index=0,showChart(Index))};function toggleSection1(e){const t=e.nextElementSibling,n=e.closest(".test-summary"),a=e.querySelector(".arrow"),o=n.classList.contains("expanded");"none"===t.style.display?a.classList.add("open"):a.classList.remove("open"),t.style.display=o?"none":"block",o||t.scrollIntoView({behavior:"smooth",block:"start"}),n.classList.toggle("expanded",!o)}document.querySelectorAll(".gherkin").forEach((e=>{""!==e.textContent.trim()?e.style.width="45px":e.style.width="0"})),document.querySelectorAll(".test-block").forEach((e=>{const t=e.querySelector(".test-details"),n=e.querySelector(".arrow"),a=e.querySelector(".test-summary");t&&t.textContent.trim().length>0?(n.setAttribute("title","Click to expand"),n.style.pointerEvents="auto"):(n.removeAttribute("title"),n.style.opacity="0",n.style.pointerEvents="none",a&&(a.onclick=null,a.style.cursor="default",a.style.pointerEvents="none"))})),document.querySelectorAll(".step").forEach((e=>{const t=e.querySelector(".step-arrow"),n=e.querySelector(".description"),a=e.nextElementSibling,o=a?.classList.contains("log")&&a.innerText.trim().length>0;t&&(o?(e.classList.add("has-log"),t.setAttribute("title","See logs"),n.setAttribute("title","See logs"),n.style.cursor="pointer",n.style.pointerEvents="auto"):(n.onclick=null,e.classList.remove("has-log"),t.removeAttribute("title"),t.style.cursor="default",t.style.pointerEvents="none"))}));const table=document.getElementById("trgan-report");table&&table.querySelectorAll("th").forEach((e=>{const t=e.querySelector(".resizer");t&&t.addEventListener("mousedown",(function(t){t.preventDefault();const n=t.pageX,a=e.offsetWidth,o=t=>{const o=a+(t.pageX-n);e.style.width=o+"px"},l=()=>{document.removeEventListener("mousemove",o),document.removeEventListener("mouseup",l)};document.addEventListener("mousemove",o),document.addEventListener("mouseup",l)}))}));